<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.3.1"/>
<title>OpenNI 1.5.7: SimpleRead.net - sample program (C#/.NET)</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="OpenNILogo.bmp"/></td>
  <td style="padding-left: 0.5em;">
   <div id="projectname">OpenNI 1.5.7
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.3.1 -->
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li class="current"><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="index.html">OpenNI Overview</a></li><li class="navelem"><a class="el" href="smpls_n_guides.html">Samples and Guides</a></li><li class="navelem"><a class="el" href="smpls.html">Sample Programs for the OpenNI API</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">SimpleRead.net - sample program (C#/.NET) </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><pre class="fragment">&lt;b&gt;Source file:&lt;/b&gt; Click the following link to view the source code file:
    - SimpleRead.net\\Program.cs

This part describes the SimpleRead sample program in the C# language for .NET.

The documentation describes the sample program's code from the top of the program file(s) to bottom.

Every OpenNI feature is described the first time it appears in this sample program. Further appearances of the same feature are not described again.            
</pre><h1><a class="anchor" id="srj_path_decl"></a>
Declaration for Script File Path</h1>
<pre class="fragment">    The following declaration sets the full path to an OpenNI XML script file of a OpenNI @ref prod_graph "production graph". The production graph is the main object model in OpenNI. It is a network of objects &amp;mdash; called @ref prod_graph production nodes &amp;mdash that implement Natural Interaction operations.
</pre><div class="fragment"><div class="line"><span class="keywordtype">string</span> SAMPLE_XML_FILE = <span class="stringliteral">@&quot;../../../../Data/SamplesConfig.xml&quot;</span>;</div>
</div><!-- fragment --><h1><a class="anchor" id="srj_node_inits"></a>
Node Declarations and Initializations</h1>
<pre class="fragment">    The following statement declares a @ref xn::ScriptNode "ScriptNode" object. The script node object loads and contains the OpenNI script and is the base node {WRT inheritance} for the production graph. The &lt;i&gt;production graph&lt;/i&gt; is a network of &lt;i&gt;production nodes&lt;/i&gt; and is the principal OpenNI object model.
</pre> <div class="fragment"><div class="line">ScriptNode scriptNode;</div>
</div><!-- fragment --><p>The following statement declares a <a class="el" href="classxn_1_1_context.html">Context</a> object and creates the production graph from an OpenNI XML script file. The context is the workspace where the application builds an OpenNI production graph. </p>
<div class="fragment"><div class="line">Context context = Context.CreateFromXmlFile(SAMPLE_XML_FILE, out scriptNode);</div>
</div><!-- fragment --><p>The <a class="el" href="classxn_1_1_context.html#a48450b0fde8c947c8ba7683a4f882308">FindExistingNode()</a> method in the following code block tries to get a reference to any production nodes in the production graph. This call specifies the <code>NodeType.Depth</code> parameter to get a reference to a <a class="el" href="classxn_1_1_depth_generator.html">DepthGenerator</a> node. A DepthGenerator node generates a depth map as an array of pixels, where each pixel is a depth value representing a distance from the sensor in millimeters. A reference to the node is returned in the depth parameter. </p>
<div class="fragment"><div class="line">DepthGenerator depth = context.FindExistingNode(NodeType.Depth) as DepthGenerator;</div>
<div class="line"><span class="keywordflow">if</span> (depth == null)</div>
<div class="line">{</div>
<div class="line">    Console.WriteLine(<span class="stringliteral">&quot;Sample must have a depth generator!&quot;</span>);</div>
<div class="line">    <span class="keywordflow">return</span>;</div>
<div class="line">}</div>
</div><!-- fragment --><p>The following statement gets the map output mode of the <a class="el" href="classxn_1_1_depth_generator.html">DepthGenerator</a> node. The map output mode is the combination of the node's scene resolution and frame rate. </p>
<div class="fragment"><div class="line">MapOutputMode mapMode = depth.MapOutputMode;</div>
</div><!-- fragment --><p>The following is the declaration of the <a class="el" href="glossary.html#glos_frame_object">&lt;i&gt;frame object&lt;/i&gt;</a> for quick and easy access to data from the <a class="el" href="classxn_1_1_depth_generator.html">DepthGenerator</a> data. </p>
<div class="fragment"><div class="line">DepthMetaData depthMD;</div>
</div><!-- fragment --><h1><a class="anchor" id="smpl_simple_read_mainloop"></a>
Main Program Loop</h1>
<pre class="fragment">        The main program loop repeatedly updates the data available in the node for output, and then gets the frame object (via the metadata object). The program then calculates the mid-point of the scene's 2D (two-dimensional) area.
</pre><div class="fragment"><div class="line"><span class="keywordflow">while</span> (!Console.KeyAvailable)</div>
<div class="line">{</div>
<div class="line"> ...</div>
<div class="line">}</div>
</div><!-- fragment --><p> The following sections describe the statements in the main program loop above.</p>
<h2><a class="anchor" id="srj_main_upd_data"></a>
Updating the Data Available for Output</h2>
<pre class="fragment">        the @ref xn::Context::WaitAnyUpdateAll() "WaitAnyUpdateAll()" method in the following statement waits for a specific node to have generated a new data frame. The method then makes the data frames of all nodes in the entire production graph available for getting. The application can then get the data (for example, using a metadata GetData() method). This method has a timeout.           
</pre> <div class="fragment"><div class="line">context.WaitOneUpdateAll(depth);</div>
</div><!-- fragment --><h2><a class="anchor" id="srj_main_get_fo"></a>
Get the DepthGenerator's Frame Object</h2>
<pre class="fragment">        In the following statement, the @ref glos_frame_object "&lt;i&gt;frame object&lt;/i&gt;" that is generated is copied to a metadata object for quick and easy access by the application. (To be exact, only a reference to the frame data itself is passed; whereas the configuration properties are actually copied.) The node's &lt;code&gt;getMetaData() &lt;/code&gt;method gets this frame object and copies it to a &lt;code&gt;depthMD&lt;/code&gt; metadata object. (It passes a reference to the frame data and actually copies the frame configuration information. The metadata includes all configuration information associated with the data itself. )
        For more explanation on this, see @ref conc_meta_data, @ref glos_frame_object and @ref frame_data.
</pre> <div class="fragment"><div class="line">depth.GetMetaData(depthMD);</div>
</div><!-- fragment --><p>The following print statement accesses the frame data, its ID, and the frame data's associated configuration, The frame ID is the ID of the frame object. Frame IDs are a sequential unique number with a wrap around. This method is inherited from the OutputMetaData class. </p>
<div class="fragment"><div class="line">Console.WriteLine(<span class="stringliteral">&quot;Frame {0} Middle point is: {1}.&quot;</span>, depthMD.FrameID, depthMD[(<span class="keywordtype">int</span>)mapMode.XRes/2, (<span class="keywordtype">int</span>)mapMode.YRes/2]);</div>
</div><!-- fragment --><p>In the above, <a class="el" href="classxn_1_1_map_meta_data.html#a88773e165cbc69e091e87781ca43bdb7">xn::MapMetaData::XRes()</a> "XRes()" and <a class="el" href="classxn_1_1_map_meta_data.html#a59e8d198dada0c527436196592dc320c">xn::MapMetaData::YRes()</a> "YRes()" are the dimensions of the FOV in the scene. The call to <code>depthMD()</code> accesses a depth pixel through an X,Y coordinate. By calculating XRes()/2 and YRes()/2, this accesses the middle pixel. </p>
</div></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Tue Nov 12 2013 13:40:21 for OpenNI 1.5.7 by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.3.1
</small></address>
</body>
</html>
